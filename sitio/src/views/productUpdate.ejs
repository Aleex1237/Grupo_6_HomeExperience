<!DOCTYPE html>
<html lang="es">
  <%- include("./partials/head")%>
<body class="productUpdate">
  <%- include("./partials/header")%>
    <main>
        <h1>Modificar experiencia</h1>
        <form id="create-product-form" action="/admin/producto/modificar/<%=producto.id%>?_method=PUT" method="POST" enctype="multipart/form-data">
          <input class="oculto" type="text" name="id" id="cp-id" value="<%=producto.id%>">
          <div class="nombre">
            <input class="nombre" type="text" name="nombre" id="cp-nombre" value="<%=locals.old ? old.nombre : producto.name%>">
            <% if (locals.errors && errors.nombre) { %>
              <p class="text-danger"><%= errors.nombre.msg %> </p>
            <% } %>
            <p id="cp-nombre-error" class="text-danger"></p>
          </div>
          <div class="contenedor">
              <div class="caja1">
                  <textarea name="descripcion" id="cp-descripcion" cols="30" rows="10" ><%=locals.old  ? old.descripcion : producto.description%></textarea>
                  <% if (locals.errors && errors.descripcion) { %>
                    <p class="text-danger"><%= errors.descripcion.msg %> </p>
                  <% } %>
                  <p id="cp-descripcion-error" class="text-danger"></p>
                  <div class="contenedor2">
                    <div>
                      <input class="precio" type="text" name="precio" id="cp-precio" value="<%=locals.old ? old.precio : producto.price%>">
                      <% if (locals.errors && errors.precio) { %>
                        <p class="text-danger"><%= errors.precio.msg %> </p>
                      <% } %>
                      <p id="cp-precio-error" class="text-danger"></p>
                      <select name="categoria" id="cp-categoria">
                        <option value=1 <%=producto.idCategory===1?"selected":null%>>Bar</option>
                        <option value=2 <%=producto.idCategory===2?"selected":null%>>Cine</option>
                      </select>
                      <% if (locals.errors && errors.categoria) { %>
                        <p class="text-danger"><%= errors.categoria.msg %> </p>
                      <% } %>
                      <p id="cp-categoria-error" class="text-danger"></p>
                    </div>
                    <div class="div-imagen" id="input-file">
                      <input class="input-file" type="file" name="imagen" placeholder="+ FOTO" value="<%=producto.image%>">
                    </div>
                    
                  </div>
                  <div>
                    <input class="precio" type="text" name="keywords" id="cp-keywords" placeholder="Palabras relacionadas" value="<%=keywords%>" required>
                    <% if (locals.errors && errors.keywords) { %>
                      <p class="text-danger"><%= errors.keywords.msg %> </p>
                    <% } %>
                    <p id="cp-keywords-error" class="text-danger"></p>
                  </div>
              </div>
              <div class="caja2">
                    <h3>Productos incluidos en la experiencia:</h3>
                    <br>
                    <input class="oculto" name="cantidadProductos" id="cp-cantidadProductos" value="<%=producto.products.length%>">
                    <input class="precio" type="text" name="product" id="cp-product" placeholder="Agregar producto">
                    <% if (locals.errors && errors.product) { %>
                      <p class="text-danger"><%= errors.product.msg %> </p>
                    <% } %>
                    <p id="cp-product-error" class="text-danger"></p>
                    <table id="cp-tabla" class="table">
                      <thead>
                        <tr>
                          <th class="letraBlanca" scope="col" color="white">#</th>
                          <th class="letraBlanca" scope="col" color="white">Producto</th>
                          <th class="letraBlanca" scope="col" color="white"></th>
                        </tr>
                      </thead>
                      <tbody id="cp-tabla-productos">
                        <%for(let i=1;i<=producto.products.length;i++){%>
                          <tr>
                            <th class="letraBlanca" scope="row" ><%=i%></th>
                            <td>
                            <input type="text" class="sinFormato" name="product<%=i%>" id="cp-product<%=i%>" value="<%=producto.products[i-1].name%>">
                            </td>
                            <td>
                              <button class="btnEliminar" id="cp-eliminar-product<%=i%>">X</button>
                            </td>
                            </tr>
                          <%}%>
                      </tbody>
                    </table>
              </div>
          </div> 
          <div>
            <button type="submit">GUARDAR</button>
          </div>
        </form>
        
    </main>
    <%- include("./partials/footer")%>
    <%- include("./partials/scripts")%>
</body>
</html>